<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDFSecure Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
			background-color: #f8f8f8;
			padding: 0;
        }
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
			color: #51247a;
        }
        input {
            width: 100%;
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            padding: 10px 20px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .preview-container {
            margin-top: 30px;
			margin-top: 20px;
     	 	border: 2px dotted #ddd;
      		padding: 0px;
      		max-width: 1200px;
      		min-height: 500px;
        }
		.subtitle {
      		font-size: 0.8em;
      		color: #999490;
    	}
		.pagetitle {
			  max-width: 1200px;
			  margin: 10px auto;
			  width: 100%;
			  padding: 5px 15px;
			  box-sizing: border-box;
			  background-color: #fff;
			  border: 1px solid #ddd;
    	}
		.step1 {
			  max-width: 1200px;
			  margin: 10px auto;
			  width: 100%;
			  padding: 5px 15px;
			  box-sizing: border-box;
			  background-color: #fff;
			  border: 1px solid #ddd;
			  padding-bottom: 20px;
			  padding-top: 10px;
    	}
		.step2 {
			  max-width: 1200px;
			  margin: 10px auto;
			  width: 100%;
			  padding: 5px;
			  box-sizing: border-box;
			  background-color: #fff;
			  border: 1px solid #ddd;
			  padding-bottom: 20px;
			  padding-top: 10px;
    	}
		h1, h2{
			color: #51247a;
		}
        iframe {
            width: 100%;
            height: 600px;
            border: 1px solid #ddd;
            margin-top: 20px;
        }
    </style>
</head>
<body>
	<div class="pagetitle">
    <iframe title="PDFSecure Generator" aria-label="Heading titled PDFSecure Generator" height="150px" width="100%" src="https://uqgblaze.github.io/UQ-Swoosh/live/flex-query.html?title=PDFSecure%20Generator" frameborder="0" scrolling="no" style="max-width:1200px; max-height: 150px!important"></iframe>
	</div>
	<div class="step1">	
	<h2>Step 1: Create the HTML file</h2>
	<p>Use the form below to generate the HTML file, as <b>you'll need to upload and host this file somewhere else on the internet</b>. The title of the document and the URL to the PDF are required, while the Javascript and CSS Stylesheet are optional as you can either re-upload and insert in the URL of these files if you're having cross-platform issues, or want to customise the code yourself.</p>
    <form id="generator-form">
        <label for="title">Title of the Document:</label>
        <input type="text" id="title" placeholder="Example PDFSecure" value="Example PDFSecure">

        <label for="pdf-url">URL to PDF:</label>
        <input type="text" id="pdf-url" placeholder="https://uqgblaze.github.io/PDFSecure/example.pdf" value="https://uqgblaze.github.io/PDFSecure/example.pdf">

        <label for="js-url">URL to JavaScript (optional):</label>
        <input type="text" id="js-url" placeholder="https://uqgblaze.github.io/PDFSecure/PDFSecure.js" value="https://uqgblaze.github.io/PDFSecure/PDFSecure.js">

        <label for="css-url">URL to CSS Stylesheet (optional):</label>
        <input type="text" id="css-url" placeholder="https://uqgblaze.github.io/PDFSecure/PDFSecure-stylesheet.css" value="https://uqgblaze.github.io/PDFSecure/PDFSecure-stylesheet.css">

        <button type="button" id="generate-btn">Generate Preview</button>
        <button type="button" id="download-btn">Download HTML File</button>
    </form>
	
	    <div class="preview-container">
        <h2>Live Preview</h2>
        <iframe id="preview-frame" src="" style="border: 1px solid #ddd; padding: 10px;"></iframe>
    	</div>
	</div>
	<div class="step2">
	<h2>Step 2: Adjust your iframe code</h2>
<p>Below is a form for you to adjust the iframe code to insert it into your site. You'll need to include the URL to the HTML file you downloaded and hosted somewhere else on the internet. Then, you can adjust the height and width of the iframe to suit the PDF.</p>
<form id="iframe-form">
  <p>
    <label for="htmlInput">Enter URL to your HTML file:</label>
    <span class="subtitle">After you have hosted the HTML file on the internet, grab the URL to that .html file and paste it in the field below</span>
    <input type="text" id="htmlInput" aria-label="Enter the URL to the HTML file" placeholder="Enter the URL to the HTML file">
  </p>
  <p>
    <label for="heightInput">Optional: Edit iframe Height (in pixels):</label>
    <span class="subtitle">Default setting: height = 600px</span>
    <input type="number" id="heightInput" aria-label="Enter the height for the iframe in pixels" placeholder="Enter height in pixels">
  </p>
  <p>
    <label for="widthInput">Optional: Edit iframe Width:</label>
    <span class="subtitle">Default setting: width = 100%</span>
    <input type="number" id="widthInput" aria-label="Enter the width for the iframe" placeholder="Enter width in pixels">
  </p>
</form>
<p>
  <label>Generated iFrame Code:</label>
  <span class="subtitle">Copy the code below and paste it into Blackboard or Edge/Extend</span>
  <textarea id="iframeCodeOutput" aria-label="Generated iframe code to copy" readonly style="background-color: #f8f9fa; width: 100%; height: 100px;"></textarea>
</p>
<button onclick="copyToClipboard()" aria-label="Copy the generated iframe code">Copy Code</button>


    <div class="preview-container">
        <p>
  		<label>Preview of the iFrame:</label><br>
  		<div id="iframePreview" style="border: 1px solid #ddd; padding: 10px;"></div>
		</p>

    </div>
	</div>
	<script>
  function generateIframeCode() {
    // Get the user inputs
    var htmlUrl = document.getElementById("htmlInput").value;
    var height = document.getElementById("heightInput").value;
    var width = document.getElementById("widthInput").value;

    // Set default values if none are provided
    if (!height) {
      height = 600; // Default height in pixels
    }
    if (!width) {
      width = "100%"; // Default width
    }

    // Generate the iframe code
    var iframeCode = `<iframe title="Secure PDF Viewer" aria-label="Embedded PDF Viewer" height="${height}" width="${width}" src="${htmlUrl}" frameborder="0" scrolling="no"></iframe>`;

    // Display the iframe code in the textarea
    document.getElementById("iframeCodeOutput").value = iframeCode;

    // Display the preview of the iframe
    document.getElementById("iframePreview").innerHTML = iframeCode;
  }

  // Function to copy the iframe code to the clipboard
  function copyToClipboard() {
    var iframeCodeText = document.getElementById("iframeCodeOutput");
    iframeCodeText.select();
    iframeCodeText.setSelectionRange(0, 99999); // For mobile devices
    document.execCommand("copy");
    alert("iFrame code copied to clipboard!");
  }

  // Attach event listeners to inputs to dynamically update the iframe code
  document.getElementById("htmlInput").addEventListener("input", generateIframeCode);
  document.getElementById("heightInput").addEventListener("input", generateIframeCode);
  document.getElementById("widthInput").addEventListener("input", generateIframeCode);
</script>

    <script>
        const form = document.getElementById('generator-form');
        const previewFrame = document.getElementById('preview-frame');

        const generateHTML = () => {
    const title = document.getElementById('title').value;
    const pdfURL = document.getElementById('pdf-url').value;
    const jsURL = document.getElementById('js-url').value;
    const cssURL = document.getElementById('css-url').value;

    return `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${title}</title>

    <!-- Custom CSS URL-->
    <link rel="stylesheet" href="${cssURL}">

    <!-- REQUIRED Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
        integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- REQUIRED PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.9.359/pdf.min.js"
        integrity="sha512-U5C477Z8VvmbYAoV4HDq17tf4wG6HXPC6/KM9+0/wEXQQ13gmKY2Zb0Z2vu0VNUWch4GlJ+Tl/dfoLOH4i2msw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"><\/script>

    <!-- Custom JavaScript URL-->
    <script src="${jsURL}" defer><\/script>

    <script>
        document.addEventListener('contextmenu', event => event.preventDefault());
    <\/script>
</head>
<body>
    <main data-pdf-url="${pdfURL}">
        <h3>${title}</h3>
        <canvas class="pdf-viewer hidden"></canvas>
    </main>
    <footer>
        <ul>
            <li class="pagination">
                <button id="previous">Previous</button>
                <span id="current_page">0 of 0</span>
                <button id="next">Next</button>
            </li>
            <li style="padding-left: 30px;">
                Zoom: <span id="zoomValue">100%</span>
                <input type="range" id="zoom" min="100" max="300" value="125" step="25">
            </li>
        </ul>
    </footer>
</body>
</html>
    `;
};


        const updatePreview = () => {
            const htmlContent = generateHTML();
            const blob = new Blob([htmlContent], { type: 'text/html' });
            previewFrame.src = URL.createObjectURL(blob);
        };

        const downloadHTML = () => {
            const htmlContent = generateHTML();
            const title = document.getElementById('title').value;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `PDFSecure-${title}.html`;
            link.click();
        };

        document.getElementById('generate-btn').addEventListener('click', updatePreview);
        document.getElementById('download-btn').addEventListener('click', downloadHTML);

        updatePreview(); // Initialize preview
    </script>
</body>
</html>
